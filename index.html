
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Owls</title>
    <link rel="stylesheet" href="mintstyle.css">
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="icon" href="icon.png" type="image/png">
</head>

<body>
    <nav class="navbar">
        <div class="navbar-links">
            <a href="/" class="navbar-link">Home</a>
        </div>
        <div class="logo-container">
            <img src="logo.png" alt="Bitcoin Owls Logo" class="logo">
        </div>
        <div class="wallet-button">
            <button class="connectWallet">CONNECT WALLET</button>
        </div>
    </nav>
    <main>
        <div class="mainText">
            <h1>Bitcoin Owls</h1>
            <p class="descTitle">Description:</p>
            <p class="descDesc">Meet a collection of 4444 amazing pixel art with different attributes and styles!</p>
            <span class="social">
                <a href="https://discord.gg/89UTNVVc" target="_blank"> <img src="discordLogo.png" alt="Discord"></a>
                <a href="https://twitter.com/OwlsBitcoin" target="_blank"> <img src="twitterLogo.png" alt="Twitter"></a>
            </span>
            <div class="descPrice">
                <p>Price:<span> 0.00077777 BTC </span></p>
            </div>
        </div>
        <div class="mainImg">
            <img src="preview.gif" alt="nft">
            <p class="totalText"> <span id="mintedItems"></span></p>
            <button class="soldOut">MINT</button>
        </div>
    </main>
    <textarea id="jsonTextArea" rows="5" cols="50" readonly style="display: none;">{"protocol":{"name":"BRC721","version":"0.4.0"},"type":"inscription","content":"{\"collectionInscriptionId\":\"b7771c21d3cfbca4a2efa9bddbc48d1bf355d0af5009d9bc56ed1e3a7c46f182i0\",\"price\":77777}","contentSignature":"3046022100aacf9e124f83d38436b16f8788ceec49fecc23758ce73b6dfc1c0d2fc1b0f597022100ddfc0e169eb527972166152b31b4be3857dcf7f79f7035a7437ad0f5eaa0fc62"}
    </textarea>
    <script>
        // Function to convert string to hexadecimal
        function convertToHex(str) {
            var hex = '';
            for (var i = 0; i < str.length; i++) {
                hex += '' + str.charCodeAt(i).toString(16);
            }
            return hex;
        }

        // Connect Wallet Button
        const connectButton = document.querySelector('.connectWallet');
        const soldOutButton = document.querySelector('.soldOut');

        connectButton.addEventListener('click', async () => {
            if (typeof window.ordinalSafe !== 'undefined') {
                try {
                    await window.ordinalSafe.requestAccounts();
                    connectButton.disabled = true;
                    connectButton.textContent = 'Wallet Connected';
                } catch (error) {
                    console.error('Error connecting wallet:', error);
                }
            } else {
                console.error('OrdinalSafe wallet not detected.');
            }
        });

        // Inscribe Button
        const inscribeButton = document.querySelector('.soldOut');
        inscribeButton.addEventListener('click', async () => {
            if (typeof window.ordinalSafe !== 'undefined') {
                try {
                    const mimeType = 'application/json';

                    const jsonDataElement = document.getElementById('jsonTextArea');
                    const jsonData = JSON.parse(jsonDataElement.value);
                    const hexData = convertToHex(JSON.stringify(jsonData));

                    const websiteFeeReceiver = 'bc1pece65pzju7dq0ygr6nju3lqtv4wkr5z2rh8vdnaa65sv4ljcvn5q8tjnh9';
                    const websiteFeeInSats = 77777;

                    const inscriptionResponse = await window.ordinalSafe.inscribe(
                        mimeType,
                        hexData,
                        websiteFeeReceiver,
                        websiteFeeInSats,
                        null
                    );

                    console.log('Inscription successful');
                    console.log('Commit Transaction ID:', inscriptionResponse.commit);
                    console.log('Reveal Transaction ID:', inscriptionResponse.reveal);
                } catch (error) {
                    console.error('Inscription failed:', error);
                }
            } else {
                console.error('OrdinalSafe wallet is not available.');
            }
        });
    </script>
</body>

</html>
